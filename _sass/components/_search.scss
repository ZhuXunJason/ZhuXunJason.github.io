/* 搜索组件 (Search Component) - 精简嵌套结构 */

// 容器（桌面端）
.search-container {
    position: relative;
    margin-left: auto;
    z-index: 10;

    #search-input {
        width: 250px;
        padding: 0.6rem 1rem 0.6rem 2.5rem;
        border: 1px solid var(--border-color);
        border-radius: 25px;
        font-size: 0.9rem;
        background-color: var(--card-bg);
        transition: var(--transition-fast);

        &:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
    }

    .search-icon {
        position: absolute;
        left: 0.8rem;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-light);
        font-size: 0.9rem;
    }
}

/* 结果列表：实体背景 + 轻微模糊（仅柔化阴影边缘，不透明） */
#search-results-container {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: #18242b; /* 不透明深色 */
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
    border: 1px solid rgba(255, 255, 255, 0.10);
    border-radius: var(--border-radius);
    box-shadow: 0 10px 34px -10px rgba(0, 0, 0, 0.55), 0 4px 14px -4px rgba(0, 0, 0, 0.4);
    max-height: 420px;
    overflow-y: auto;
    z-index: 1000;
    margin-top: .55rem;
    display: none;
    padding: 4px 0;
    transition: background .35s ease, box-shadow .4s ease, border-color .4s ease;

    &.show { display: block; }

    .search-result-item {
        display: block;
        padding: .75rem 1.05rem .8rem 1.05rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.06);
        transition: background .3s ease, color .3s ease;
        position: relative;

        &:last-child { border-bottom: none; }
        &:hover { background: rgba(255, 255, 255, 0.06); color: var(--primary-color); }
        &.selected { background: linear-gradient(120deg, rgba(255, 255, 255, 0.14), rgba(255, 255, 255, 0.05)); border-left: 4px solid var(--primary-color); }

        .search-result-title {
            font-weight: 600;
            color: var(--text-color);
            margin-bottom: 0.25rem;
            font-size: 0.95rem;
        }

        .search-result-meta {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            flex-wrap: wrap;
        }

        .search-result-tag {
            font-size: 0.7rem;
            padding: 0.15rem 0.5rem;
            border-radius: 10px;
            color: var(--card-bg);
            margin-right: 0.5rem;
            text-transform: uppercase;
            &.academic { background-color: #2563e8; }
            &.life { background-color: #27ae60; }
            &.default { background-color: #f39c12; }
        }

        .search-result-snippet {
            font-size: 0.8rem;
            color: var(--text-light);
            display: -webkit-box; /* 多行省略 */
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            line-clamp: 2;
            overflow: hidden;
        }

        .search-result-date {
            font-size: 0.7rem;
            color: var(--text-light);
            background-color: var(--bg-color);
            padding: 0.1rem 0.4rem;
            border-radius: 10px;
        }
    }
}

/* 亮色模式覆盖 */
html[data-theme="light"] {
    #search-results-container {
        background: #ffffff;
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
        border-color: rgba(0, 0, 0, 0.08);
        box-shadow: 0 8px 28px -10px rgba(0, 0, 0, 0.18), 0 3px 10px -3px rgba(0, 0, 0, 0.1);

        .search-result-item {
            border-bottom: 1px solid rgba(0, 0, 0, 0.06);
            &:hover { background: rgba(0, 0, 0, 0.05); }
            &.selected { background: linear-gradient(120deg, rgba(0, 0, 0, 0.08), rgba(0, 0, 0, 0.03)); }
        }
    }
}

/* Glass Header 区域专属样式 */
.header {
    .search-container {
        background: transparent;
        border: none;
        box-shadow: none;

        #search-input {
            all: unset;
            width: 320px;
            max-width: 42vw;
            padding: 10px 36px 10px 34px;
            border-radius: 999px;
            color: var(--text);
            font-size: 0.9rem;
            &::placeholder { color: #9aa3b2; }
        }
    }
}

@media (max-width:780px) {
    .header {
        .search-container {
            #search-input { width: 0; padding: 0; opacity: 0; }
        }
        &.is-searching .search-container #search-input { width: 100%; opacity: 1; }
    }
}
